(function(e){function t(t){for(var r,o,i=t[0],l=t[1],c=t[2],u=0,h=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&h.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(h.length)h.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(r=!1)}r&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},s={index:0},n=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"primary",dark:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("div",{staticClass:"d-flex align-center"},[a("h2",[e._v("Lab Telemetry")])]),a("v-spacer"),a("DarkButton")],1),a("v-navigation-drawer",{attrs:{app:"",clipped:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("WebsocketConnection",{on:{error:e.onError}}),a("v-divider",{staticClass:"ma-3"}),a("div",{staticClass:"d-flex align-center justify-center flex-column"},[a("p",[e._v(e._s(e.frameCount)+" frames")]),a("v-btn",{staticClass:"mb-3",on:{click:e.saveFrames}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cloud-download")]),e._v(" Save Frame Data ")],1),a("input",{ref:"fileInput",attrs:{type:"file",hidden:""},on:{change:e.fileChange}}),a("v-btn",{staticClass:"mb-3",on:{click:e.loadFrames}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cloud-upload")]),e._v(" Load Frame Data ")],1),a("FramePlayback")],1)],1),a("v-main",[a("v-snackbar",{attrs:{color:"error",bottom:""},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[a("v-btn",e._b({attrs:{text:""},on:{click:function(t){e.errorSnackbar=!1}}},"v-btn",r,!1),[e._v(" Close ")])]}}]),model:{value:e.errorSnackbar,callback:function(t){e.errorSnackbar=t},expression:"errorSnackbar"}},[e._v(" "+e._s(e.error)+" ")]),a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("ArenaCanvas")],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("FrameInfo")],1)],1)],1)],1)],1)},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-flex align-center justify-center"},[a("v-form",{staticClass:"d-flex align-center flex-column",attrs:{action:"javascript:void(0);"}},[a("v-text-field",{staticClass:"ma-2",attrs:{outlined:"",filled:"","hide-details":"",placeholder:"Robot IP"},model:{value:e.ip,callback:function(t){e.ip=t},expression:"ip"}}),e.connected?e._e():a("v-btn",{attrs:{loading:e.loading,color:"success",type:"submit"},on:{click:e.connect}},[e._v(" Connect ")]),e.connected?a("v-btn",{attrs:{color:"error"},on:{click:e.disconnect}},[e._v(" Disconnect ")]):e._e()],1)],1)},i=[],l={name:"WebsocketConnection",data:()=>({loading:!1,connected:!1,ip:"ws://localhost:9090",websocket:null}),methods:{connect(){try{this.websocket=new WebSocket(this.ip),this.loading=!0,this.websocket.addEventListener("open",()=>{this.loading=!1,this.connected=!0,console.log("Opened!")},{once:!0}),this.websocket.addEventListener("close",e=>{this.loading=!1,this.connected=!1,console.log("Websocket closed with code "+e.code)},{once:!0}),this.websocket.addEventListener("error",e=>{console.error("Websocket error: ",e),this.$emit("error","Error connecting to websocket"),this.loading=!1}),this.websocket.addEventListener("message",e=>{const t=JSON.parse(e.data);this.$store.commit("addFrame",t)})}catch(e){this.loading=!1,this.$emit("error",e.toString())}},disconnect(){this.loading=!1,this.websocket.close()}}},c=l,d=a("2877"),u=a("6544"),h=a.n(u),m=a("8336"),p=a("4bd4"),f=a("8654"),v=Object(d["a"])(c,o,i,!1,null,"d9af7414",null),b=v.exports;h()(v,{VBtn:m["a"],VForm:p["a"],VTextField:f["a"]});var g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-list",{attrs:{nav:"",dense:""}},[a("v-list-item-group",{attrs:{"active-class":"deep-purple--text text--accent-4"},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}},[a("v-list-item",[a("v-list-item-title",[e._v("Foo")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Bar")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Fizz")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Buzz")])],1)],1)],1)},k=[],y={name:"FrameSidebar",data:()=>({group:null})},w=y,_=a("8860"),x=a("da13"),$=a("1baa"),F=a("5d23"),S=Object(d["a"])(w,g,k,!1,null,"7d456f89",null),C=S.exports;h()(S,{VList:_["a"],VListItem:x["a"],VListItemGroup:$["a"],VListItemTitle:F["a"]});var P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],ref:"container",staticClass:"d-flex justify-center",attrs:{fluid:""}},[a("canvas",{ref:"canvas",staticClass:"elevation-2"})])},V=[];const O=4e3,I=O,T=140,M=1700;var j={name:"ArenaCanvas",data:()=>({size:0}),mounted(){setTimeout(()=>{this.onResize()},1)},computed:{frame(){return this.$store.getters.selectedFrame}},watch:{frame(){this.draw()},"$vuetify.theme.dark":function(){this.draw()}},methods:{onResize(){const e=getComputedStyle(this.$refs.container),t=this.$refs.container.offsetWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight);this.size=Math.min(window.innerHeight-100,t),this.$refs.canvas.width=this.size,this.$refs.canvas.height=this.size,this.draw()},draw(){const e=this.$refs.canvas.getContext("2d");e.save();const t={background:this.$vuetify.theme.dark?"#121212":"#FFFFFF",backgroundLine:this.$vuetify.theme.dark?"#d5d5d5de":"#121212",bot:this.$vuetify.theme.dark?"deepskyblue":"blue",ultrasonic:"red",customLine:"purple",customDot:"purple",goal:this.$vuetify.theme.dark?"lightgreen":"green"};try{e.scale(this.size/I,this.size/O),e.clearRect(0,0,I,O),e.fillStyle=t.backgroundLine,e.fillRect(0,0,I,O),e.fillStyle=t.background;const a=10;e.fillRect(a,a,I-2*a,O-2*a),e.fillStyle=t.backgroundLine;const r=8;e.fillRect(I/2-r/2,0,r,I),e.fillRect(0,O/2-r/2,O,r);const s=this.frame;if(s){if(s.hasOwnProperty("pos")&&s.hasOwnProperty("angle")){e.save();const a=1e3*s.pos[0],r=1e3*s.pos[1];e.translate(a+I/2,-1*r+O/2),e.rotate(s.angle),e.beginPath();const n=10;if(e.lineWidth=n,e.strokeStyle=t.bot,e.arc(0,0,T,0,2*Math.PI,!0),e.stroke(),e.beginPath(),e.lineWidth=20,e.moveTo(0,0),e.lineTo(0,-1*T),e.stroke(),s.hasOwnProperty("ultrasonic")){const a=10;for(let r=0;r<s.ultrasonic.length;r++){e.save();const o=-.5*Math.PI+Math.PI*(r/(s.ultrasonic.length-1));e.rotate(o),e.translate(0,-1*(T+n/2)),e.fillStyle=t.ultrasonic,e.fillRect(a/2*-1,0,a,-1*Math.min(10*s.ultrasonic[r],M)),e.restore()}}e.restore()}if(s.hasOwnProperty("lines"))for(const a of s.lines)e.beginPath(),e.lineWidth=10,e.strokeStyle=t.customLine,e.moveTo(a[0][0]+I/2,-1*a[0][1]+O/2),e.lineTo(a[1][0]+I/2,-1*a[1][1]+O/2),e.stroke();if(s.hasOwnProperty("dots"))for(const a of s.dots)e.beginPath(),e.lineWidth=10,e.strokeStyle=t.customDot,e.arc(a[0]+I/2,-1*a[1]+O/2,10,0,2*Math.PI,!0),e.stroke();s.hasOwnProperty("goal")&&(e.beginPath(),e.lineWidth=20,e.fillStyle=t.goal,e.arc(1e3*s.goal[0]+I/2,-1e3*s.goal[1]+O/2,30,0,2*Math.PI,!0),e.fill())}}catch(a){console.error(a)}e.restore()}}},L=j,D=a("a523"),E=a("269a"),z=a.n(E),R=a("dc22"),B=Object(d["a"])(L,P,V,!1,null,"45a00064",null),W=B.exports;h()(B,{VContainer:D["a"]}),z()(B,{Resize:R["a"]});var A=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"ma-3"},[a("v-card-title",[e._v("Frame Info")]),a("v-card-text",[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v(" Name ")]),a("th",{staticClass:"text-left"},[e._v(" Value ")])])]),a("tbody",e._l(e.tableData,(function(t){return a("tr",{key:t.name},[a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.value))])])})),0)]},proxy:!0}])})],1)],1)},N=[],J={name:"FrameInfo",computed:{tableData(){const e=this.$store.getters.selectedFrame;if(!e)return[];const t=[];return e.hasOwnProperty("state")&&t.push({name:"State",value:e.state}),e.hasOwnProperty("pos")&&(t.push({name:"X",value:Math.round(100*e.pos[0])/100}),t.push({name:"Y",value:Math.round(100*e.pos[1])/100})),e.hasOwnProperty("angle")&&t.push({name:"Angle",value:Math.round(e.angle*(180/Math.PI)*100)/100+"Â°"}),e.hasOwnProperty("goal_distance")&&t.push({name:"Goal Distance",value:Math.round(100*e.goal_distance)/100}),e.hasOwnProperty("v")&&(t.push({name:"Forward Velocity",value:Math.round(100*e.v)/100}),t.push({name:"Angular Velocity",value:Math.round(100*e.w)/100})),t}}},G=J,H=a("b0af"),U=a("99d9"),X=a("1f4f"),Y=Object(d["a"])(G,A,N,!1,null,"5defbf55",null),q=Y.exports;h()(Y,{VCard:H["a"],VCardText:U["a"],VCardTitle:U["b"],VSimpleTable:X["a"]});var K=a("21a6"),Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"d-flex align-center justify-center"},[a("v-btn",{attrs:{disabled:e.atStart},on:{click:e.goToStart}},[a("v-icon",[e._v("mdi-rewind")])],1),e.paused?a("v-btn",{attrs:{color:"success",disabled:e.atLatest},on:{click:e.play}},[a("v-icon",[e._v("mdi-play")])],1):e._e(),e.paused?e._e():a("v-btn",{attrs:{color:"warning",disabled:e.atLatest},on:{click:e.pause}},[a("v-icon",[e._v("mdi-pause")])],1),a("v-btn",{attrs:{disabled:e.atLatest},on:{click:e.goToEnd}},[a("v-icon",[e._v("mdi-fast-forward")])],1)],1),a("p",{staticClass:"text-center"},[e._v("Current frame: "+e._s(e.currentFrame))]),a("label",{attrs:{for:"playback-speed"}},[e._v("Playback Speed")]),a("v-slider",{attrs:{"thumb-label":"",step:"0.1",max:"10",min:"0.1"},scopedSlots:e._u([{key:"append",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{id:"playback-speed","hide-details":"","single-line":"",type:"number"},model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}})]},proxy:!0}]),model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}})],1)},Z=[],ee={name:"FramePlayback",data:()=>({paused:!0,nextTimeoutID:-1,speed:1}),computed:{atLatest(){return-1===this.$store.state.selected||this.$store.state.selected===this.$store.state.frames.length-1},currentFrame(){const e=this.$store.state.selected;return-1===e?this.$store.state.frames.length-1:e},atStart(){return 0===this.currentFrame||0===this.$store.state.frames.length}},methods:{goToStart(){this.$store.commit("selectFrame",0),this.paused||this.pause()},goToEnd(){this.$store.commit("selectFrame",-1),this.paused||this.pause()},play(){this.paused=!1,this.nextFrame()},pause(){this.paused=!0,-1!==this.nextTimeoutID&&clearTimeout(this.nextTimeoutID)},nextFrame(){if(this.$store.state.selected>=this.$store.state.frames.length-1)return this.nextTimeoutID=-1,void this.pause();const e=this.$store.state.frames[this.$store.state.selected+1],t=e["sent_time"]-this.$store.getters.selectedFrame["sent_time"];this.$store.commit("selectFrame",this.$store.state.selected+1),this.nextTimeoutID=setTimeout(()=>{this.nextFrame()},t*(1/this.speed))}}},te=ee,ae=a("132d"),re=a("ba0d"),se=Object(d["a"])(te,Q,Z,!1,null,"25a93a16",null),ne=se.exports;h()(se,{VBtn:m["a"],VIcon:ae["a"],VSlider:re["a"],VTextField:f["a"]});var oe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,s=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.toggleMode}},"v-btn",s,!1),r),[a("v-icon",[e._v(e._s(e.oppositeIcon))])],1)]}}])},[a("span",[e._v("Use "+e._s(e.oppositeModeName)+" Mode")])])},ie=[],le=a("a002"),ce=a.n(le),de={name:"DarkButton",computed:{oppositeIcon(){return"mdi-"+(this.$vuetify.theme.dark?"white-balance-sunny":"weather-night")},oppositeModeName(){return this.$vuetify.theme.dark?"Light":"Dark"}},methods:{toggleMode(){this.$vuetify.theme.dark=!this.$vuetify.theme.dark}},watch:{"$vuetify.theme.dark":function(e){ce.a.setItem("theme",e?"dark":"light")}},mounted(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{this.$vuetify.theme.dark=e.matches})}},ue=de,he=a("3a2f"),me=Object(d["a"])(ue,oe,ie,!1,null,"1e97e2a5",null),pe=me.exports;async function fe(e){return new Promise((t,a)=>{const r=new FileReader;r.onload=e=>{try{t(JSON.parse(e.target.result))}catch(r){a(r)}},r.onerror=e=>a(e),r.readAsText(e)})}h()(me,{VBtn:m["a"],VIcon:ae["a"],VTooltip:he["a"]});var ve={name:"App",components:{DarkButton:pe,FramePlayback:ne,FrameInfo:q,ArenaCanvas:W,FrameSidebar:C,WebsocketConnection:b},data:()=>({drawer:null,errorSnackbar:!1,error:""}),computed:{frameCount(){return this.$store.state.frames.length}},methods:{async fileChange(e){try{const t=await fe(e.target.files[0]);this.$store.commit("loadState",t),this.$store.commit("selectFrame",0)}catch(t){console.error(t),this.onError(t.toString())}},saveFrames(){const e=JSON.stringify(this.$store.state),t=(new TextEncoder).encode(e),a=new Blob([t],{type:"application/json;charset=utf-8"});Object(K["saveAs"])(a,"frames.json")},loadFrames(){this.$refs.fileInput.click()},onError(e){this.errorSnackbar=!0,this.error=e}}},be=ve,ge=a("7496"),ke=a("40dc"),ye=a("5bc1"),we=a("62ad"),_e=a("ce7e"),xe=a("f6c4"),$e=a("f774"),Fe=a("0fd9"),Se=a("2db4"),Ce=a("2fa4"),Pe=Object(d["a"])(be,s,n,!1,null,null,null),Ve=Pe.exports;h()(Pe,{VApp:ge["a"],VAppBar:ke["a"],VAppBarNavIcon:ye["a"],VBtn:m["a"],VCol:we["a"],VContainer:D["a"],VDivider:_e["a"],VIcon:ae["a"],VMain:xe["a"],VNavigationDrawer:$e["a"],VRow:Fe["a"],VSnackbar:Se["a"],VSpacer:Ce["a"]});var Oe=a("2f62");r["a"].use(Oe["a"]);var Ie=new Oe["a"].Store({state:{frames:[],selected:-1},mutations:{addFrame(e,t){e.frames.push(t)},loadState(e,t){e.frames=t.frames,e.selected=-1},selectFrame(e,t){t<e.frames.length&&(e.selected=t)},unselectFrame(e){e.selected=-1}},actions:{},modules:{},getters:{selectedFrame(e){return-1===e.selected?e.frames[e.frames.length-1]:e.frames[e.selected]}}}),Te=a("f309");r["a"].config.productionTip=!1,r["a"].use(Te["a"]),ce.a.config({name:"mobile-robotics-lab-web"}),ce.a.getItem("theme").then(e=>{e||(e=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),new r["a"]({vuetify:new Te["a"]({theme:{dark:"light"!==e}}),store:Ie,render:function(e){return e(Ve)}}).$mount("#app")})}});
//# sourceMappingURL=index.69942c0c.js.map