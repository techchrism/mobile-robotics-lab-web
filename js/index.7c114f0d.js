(function(e){function t(t){for(var r,o,i=t[0],l=t[1],c=t[2],u=0,p=[];u<i.length;u++)o=i[u],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&p.push(s[o][0]),s[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==s[l]&&(r=!1)}r&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},s={index:0},n=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var d=l;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"primary",dark:"","clipped-left":""}},[a("v-app-bar-nav-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("div",{staticClass:"d-flex align-center"},[a("h2",[e._v("Lab Telemetry")])]),a("v-spacer")],1),a("v-navigation-drawer",{attrs:{app:"",clipped:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("WebsocketConnection"),a("v-divider",{staticClass:"ma-3"}),a("div",{staticClass:"d-flex align-center justify-center flex-column"},[a("p",[e._v(e._s(e.frameCount)+" frames")]),a("v-btn",{staticClass:"mb-3",on:{click:e.saveFrames}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cloud-download")]),e._v(" Save Frame Data ")],1),a("input",{ref:"fileInput",attrs:{type:"file",hidden:""},on:{change:e.fileChange}}),a("v-btn",{staticClass:"mb-3",on:{click:e.loadFrames}},[a("v-icon",{attrs:{left:""}},[e._v("mdi-cloud-upload")]),e._v(" Load Frame Data ")],1),a("FramePlayback")],1)],1),a("v-main",[a("v-container",{attrs:{fluid:""}},[a("v-row",[a("v-col",{attrs:{cols:"12",md:"6"}},[a("ArenaCanvas")],1),a("v-col",{attrs:{cols:"12",md:"6"}},[a("FrameInfo")],1)],1)],1)],1)],1)},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"d-flex align-center justify-center"},[a("v-form",{staticClass:"d-flex align-center flex-column",attrs:{action:"javascript:void(0);"}},[a("v-text-field",{staticClass:"ma-2",attrs:{outlined:"","background-color":"white",light:"",filled:"","hide-details":"",placeholder:"Robot IP"},model:{value:e.ip,callback:function(t){e.ip=t},expression:"ip"}}),e.connected?e._e():a("v-btn",{attrs:{loading:e.loading,color:"success",type:"submit"},on:{click:e.connect}},[e._v(" Connect ")]),e.connected?a("v-btn",{attrs:{color:"error"},on:{click:e.disconnect}},[e._v(" Disconnect ")]):e._e()],1),a("v-snackbar",{attrs:{color:"error",bottom:""},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[a("v-btn",e._b({attrs:{text:""},on:{click:function(t){e.errorSnackbar=!1}}},"v-btn",r,!1),[e._v(" Close ")])]}}]),model:{value:e.errorSnackbar,callback:function(t){e.errorSnackbar=t},expression:"errorSnackbar"}},[e._v(" "+e._s(e.error)+" ")])],1)},i=[],l={name:"WebsocketConnection",data:()=>({loading:!1,connected:!1,ip:"ws://localhost:9090",websocket:null,errorSnackbar:!1,error:""}),methods:{connect(){try{this.websocket=new WebSocket(this.ip),this.loading=!0,this.websocket.addEventListener("open",()=>{this.loading=!1,this.connected=!0,console.log("Opened!")},{once:!0}),this.websocket.addEventListener("close",e=>{this.loading=!1,this.connected=!1,console.log("Websocket closed with code "+e.code)},{once:!0}),this.websocket.addEventListener("error",e=>{console.error("Websocket error: ",e),this.errorSnackbar=!0,this.loading=!1,this.error=e}),this.websocket.addEventListener("message",e=>{const t=JSON.parse(e.data);this.$store.commit("addFrame",t)})}catch(e){this.errorSnackbar=!0,this.loading=!1,this.error=e.toString(),console.error(e)}},disconnect(){this.loading=!1,this.websocket.close()}}},c=l,d=a("2877"),u=a("6544"),p=a.n(u),f=a("8336"),h=a("4bd4"),m=a("2db4"),v=a("8654"),b=Object(d["a"])(c,o,i,!1,null,"4664a626",null),g=b.exports;p()(b,{VBtn:f["a"],VForm:h["a"],VSnackbar:m["a"],VTextField:v["a"]});var y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-list",{attrs:{nav:"",dense:""}},[a("v-list-item-group",{attrs:{"active-class":"deep-purple--text text--accent-4"},model:{value:e.group,callback:function(t){e.group=t},expression:"group"}},[a("v-list-item",[a("v-list-item-title",[e._v("Foo")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Bar")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Fizz")])],1),a("v-list-item",[a("v-list-item-title",[e._v("Buzz")])],1)],1)],1)},w=[],k={name:"FrameSidebar",data:()=>({group:null})},_=k,x=a("8860"),S=a("da13"),F=a("1baa"),C=a("5d23"),P=Object(d["a"])(_,y,w,!1,null,"7d456f89",null),$=P.exports;p()(P,{VList:x["a"],VListItem:S["a"],VListItemGroup:F["a"],VListItemTitle:C["a"]});var O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",{directives:[{name:"resize",rawName:"v-resize",value:e.onResize,expression:"onResize"}],ref:"container",staticClass:"d-flex justify-center",attrs:{fluid:""}},[a("canvas",{ref:"canvas",staticClass:"elevation-2"})])},V=[];const T=4e3,I=T,j=140,M=1700;var z={name:"ArenaCanvas",data:()=>({size:0}),mounted(){setTimeout(()=>{this.onResize()},1)},computed:{frame(){return this.$store.getters.selectedFrame}},watch:{frame(){this.draw()}},methods:{onResize(){const e=getComputedStyle(this.$refs.container),t=this.$refs.container.offsetWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight);this.size=Math.min(window.innerHeight-100,t),this.$refs.canvas.width=this.size,this.$refs.canvas.height=this.size,this.draw()},draw(){const e=this.$refs.canvas.getContext("2d");e.save();try{e.scale(this.size/I,this.size/T),e.clearRect(0,0,I,T),e.fillStyle="black",e.fillRect(0,0,I,T),e.fillStyle="white";const t=5;e.fillRect(t,t,I-2*t,T-2*t),e.fillStyle="black",e.fillRect(I/2-1,0,2,I),e.fillRect(0,T/2-1,T,2);const a=this.frame;if(a){if(a.hasOwnProperty("pos")&&a.hasOwnProperty("angle")){e.save();const t=1e3*a.pos[0],r=1e3*a.pos[1];if(e.translate(t+I/2,-1*r+T/2),e.rotate(a.angle),e.beginPath(),e.lineWidth=5,e.strokeStyle="blue",e.arc(0,0,j,0,2*Math.PI,!0),e.stroke(),e.beginPath(),e.lineWidth=10,e.moveTo(0,0),e.lineTo(0,-1*j),e.stroke(),a.hasOwnProperty("ultrasonic"))for(let s=0;s<a.ultrasonic.length;s++){e.save();const t=-.5*Math.PI+Math.PI*(s/(a.ultrasonic.length-1));e.rotate(t),e.translate(0,-1*j),e.fillStyle="red",e.fillRect(-3,0,6,-1*Math.min(10*a.ultrasonic[s],M)),e.restore()}e.restore()}if(a.hasOwnProperty("lines"))for(const t of a.lines)e.beginPath(),e.lineWidth=10,e.strokeStyle="purple",e.moveTo(t[0][0]+I/2,-1*t[0][1]+T/2),e.lineTo(t[1][0]+I/2,-1*t[1][1]+T/2),e.stroke();if(a.hasOwnProperty("dots"))for(const t of a.dots)e.beginPath(),e.lineWidth=10,e.strokeStyle="purple",e.arc(t[0]+I/2,-1*t[1]+T/2,10,0,2*Math.PI,!0),e.stroke();a.hasOwnProperty("goal")&&(e.beginPath(),e.lineWidth=20,e.fillStyle="green",e.arc(1e3*a.goal[0]+I/2,-1e3*a.goal[1]+T/2,30,0,2*Math.PI,!0),e.fill())}}catch(t){console.error(t)}e.restore()}}},L=z,R=a("a523"),D=a("269a"),E=a.n(D),W=a("dc22"),A=Object(d["a"])(L,O,V,!1,null,"bdcf4ef8",null),B=A.exports;p()(A,{VContainer:R["a"]}),E()(A,{Resize:W["a"]});var N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-card",{staticClass:"ma-3"},[a("v-card-title",[e._v("Frame Info")]),a("v-card-text",[a("v-simple-table",{scopedSlots:e._u([{key:"default",fn:function(){return[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[e._v(" Name ")]),a("th",{staticClass:"text-left"},[e._v(" Value ")])])]),a("tbody",e._l(e.tableData,(function(t){return a("tr",{key:t.name},[a("td",[e._v(e._s(t.name))]),a("td",[e._v(e._s(t.value))])])})),0)]},proxy:!0}])})],1)],1)},J=[],G={name:"FrameInfo",computed:{tableData(){const e=this.$store.getters.selectedFrame;if(!e)return[];const t=[];return e.hasOwnProperty("state")&&t.push({name:"State",value:e.state}),e.hasOwnProperty("pos")&&(t.push({name:"X",value:Math.round(100*e.pos[0])/100}),t.push({name:"Y",value:Math.round(100*e.pos[1])/100})),e.hasOwnProperty("angle")&&t.push({name:"Angle",value:Math.round(e.angle*(180/Math.PI)*100)/100+"Â°"}),e.hasOwnProperty("goal_distance")&&t.push({name:"Goal Distance",value:Math.round(100*e.goal_distance)/100}),e.hasOwnProperty("v")&&(t.push({name:"Forward Velocity",value:Math.round(100*e.v)/100}),t.push({name:"Angular Velocity",value:Math.round(100*e.w)/100})),t}}},H=G,X=a("b0af"),Y=a("99d9"),q=a("1f4f"),K=Object(d["a"])(H,N,J,!1,null,"5defbf55",null),Q=K.exports;p()(K,{VCard:X["a"],VCardText:Y["a"],VCardTitle:Y["b"],VSimpleTable:q["a"]});var U=a("21a6"),Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"d-flex align-center justify-center"},[a("v-btn",{attrs:{disabled:e.atStart},on:{click:e.goToStart}},[a("v-icon",[e._v("mdi-rewind")])],1),e.paused?a("v-btn",{attrs:{color:"success",disabled:e.atLatest},on:{click:e.play}},[a("v-icon",[e._v("mdi-play")])],1):e._e(),e.paused?e._e():a("v-btn",{attrs:{color:"warning",disabled:e.atLatest},on:{click:e.pause}},[a("v-icon",[e._v("mdi-pause")])],1),a("v-btn",{attrs:{disabled:e.atLatest},on:{click:e.goToEnd}},[a("v-icon",[e._v("mdi-fast-forward")])],1)],1),a("p",{staticClass:"text-center"},[e._v("Current frame: "+e._s(e.currentFrame))]),a("label",{attrs:{for:"playback-speed"}},[e._v("Playback Speed")]),a("v-slider",{attrs:{"thumb-label":"",step:"0.1",max:"10",min:"0.1"},scopedSlots:e._u([{key:"append",fn:function(){return[a("v-text-field",{staticClass:"mt-0 pt-0",staticStyle:{width:"60px"},attrs:{id:"playback-speed","hide-details":"","single-line":"",type:"number"},model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}})]},proxy:!0}]),model:{value:e.speed,callback:function(t){e.speed=t},expression:"speed"}})],1)},ee=[],te={name:"FramePlayback",data:()=>({paused:!0,nextTimeoutID:-1,speed:1}),computed:{atLatest(){return-1===this.$store.state.selected||this.$store.state.selected===this.$store.state.frames.length-1},currentFrame(){const e=this.$store.state.selected;return-1===e?this.$store.state.frames.length-1:e},atStart(){return 0===this.currentFrame||0===this.$store.state.frames.length}},methods:{goToStart(){this.$store.commit("selectFrame",0),this.paused||this.pause()},goToEnd(){this.$store.commit("selectFrame",-1),this.paused||this.pause()},play(){this.paused=!1,this.nextFrame()},pause(){this.paused=!0,-1!==this.nextTimeoutID&&clearTimeout(this.nextTimeoutID)},nextFrame(){if(this.$store.state.selected>=this.$store.state.frames.length-1)return this.nextTimeoutID=-1,void this.pause();const e=this.$store.state.frames[this.$store.state.selected+1],t=e["sent_time"]-this.$store.getters.selectedFrame["sent_time"];this.$store.commit("selectFrame",this.$store.state.selected+1),this.nextTimeoutID=setTimeout(()=>{this.nextFrame()},t*(1/this.speed))}}},ae=te,re=a("132d"),se=a("ba0d"),ne=Object(d["a"])(ae,Z,ee,!1,null,"25a93a16",null),oe=ne.exports;async function ie(e){return new Promise((t,a)=>{const r=new FileReader;r.onload=e=>t(JSON.parse(e.target.result)),r.onerror=e=>a(e),r.readAsText(e)})}p()(ne,{VBtn:f["a"],VIcon:re["a"],VSlider:se["a"],VTextField:v["a"]});var le={name:"App",components:{FramePlayback:oe,FrameInfo:Q,ArenaCanvas:B,FrameSidebar:$,WebsocketConnection:g},data:()=>({drawer:null}),computed:{frameCount(){return this.$store.state.frames.length}},methods:{async fileChange(e){const t=await ie(e.target.files[0]);console.log(t),this.$store.commit("loadState",t)},saveFrames(){const e=JSON.stringify(this.$store.state),t=(new TextEncoder).encode(e),a=new Blob([t],{type:"application/json;charset=utf-8"});Object(U["saveAs"])(a,"frames.json")},loadFrames(){this.$refs.fileInput.click()}}},ce=le,de=a("7496"),ue=a("40dc"),pe=a("5bc1"),fe=a("62ad"),he=a("ce7e"),me=a("f6c4"),ve=a("f774"),be=a("0fd9"),ge=a("2fa4"),ye=Object(d["a"])(ce,s,n,!1,null,null,null),we=ye.exports;p()(ye,{VApp:de["a"],VAppBar:ue["a"],VAppBarNavIcon:pe["a"],VBtn:f["a"],VCol:fe["a"],VContainer:R["a"],VDivider:he["a"],VIcon:re["a"],VMain:me["a"],VNavigationDrawer:ve["a"],VRow:be["a"],VSpacer:ge["a"]});var ke=a("2f62");r["a"].use(ke["a"]);var _e=new ke["a"].Store({state:{frames:[],selected:-1},mutations:{addFrame(e,t){e.frames.push(t)},loadState(e,t){e.frames=t.frames,e.selected=-1},selectFrame(e,t){t<e.frames.length&&(e.selected=t)},unselectFrame(e){e.selected=-1}},actions:{},modules:{},getters:{selectedFrame(e){return-1===e.selected?e.frames[e.frames.length-1]:e.frames[e.selected]}}}),xe=a("f309");r["a"].use(xe["a"]);var Se=new xe["a"]({});r["a"].config.productionTip=!1,new r["a"]({store:_e,vuetify:Se,render:function(e){return e(we)}}).$mount("#app")}});
//# sourceMappingURL=index.7c114f0d.js.map